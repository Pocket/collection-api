FROM node:20.11@sha256:a57b18bad845088dbe53c0362c0be00a8b26098f4d12b805d04812223437f505
WORKDIR /usr/src/app

ARG GIT_SHA

COPY . .

ENV NODE_ENV=production
ENV PORT 4004
ENV GIT_SHA=${GIT_SHA}

ENV NODE_OPTIONS=--max-old-space-size=8192

EXPOSE ${PORT}

CMD ["npm", "start"]
